from aiogram import Router
from aiogram.types import Message
from aiogram.filters import CommandStart
from keyboards import reply
from extensions import dbcreate


# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ –±–æ—Ç–µ.
router = Router()


# –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã /start
@router.message(CommandStart())
async def start_command(message:Message):
    # –í—ã–∑—ã–≤–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
    await dbcreate.init_db()
    # –ò–∑ –æ–±—ä–µ–∫—Ç–∞ message –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—á–∞—Ç–∞), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–∏–ª –∫–æ–º–∞–Ω–¥—É
    chat_id = message.from_user.id
    try:
        # –≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –µ–≥–æ chat_id
        await dbcreate.create_user(chat_id)
        await message.answer(f'–ü—Ä–∏–≤–µ—Ç, {message.from_user.username}!üëãüëãüëã\n'
                             f'–Ø –≤–∞—à –±–æ—Ç –ø–æ–º–æ—â–Ω–∏–∫! –í–æ—Ç, —á—Ç–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ –¥–µ–ª–∞—Ç—å:\n'
                             f'\n'
                             f'–î–æ–±–∞–≤–ª—è—Ç—å –∑–∞–ø–∏—Å–∏ –≤ —Å–≤–æ–π –µ–∂–µ–¥–Ω–µ–≤–Ω–∏–∫ üìî\n'
                             f'–¢–∞–∫ –∂–µ –≤—ã –º–æ–∂–µ—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å –∏—Ö! –Ø –∑–∞–ø–æ–º–Ω—é –≤—Å–µ!\n'
                             f'\n'
                             f'–ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏, –æ –∫–æ—Ç–æ—Ä—ã—Ö —è —Ç–µ–±–µ –Ω–∞–ø–æ–º–Ω—é üïö\n'
                             f'\n'
                             f'–¢–∞–∫ –∂–µ –º–æ–≥—É –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å–æ–±—Ä–∞—Ç—å –≤–µ—â–∏, —á—Ç–æ –±—ã —Ç—ã –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–±—ã–ª!\n'
                             f'–í–º–µ—Å—Ç–µ —É –Ω–∞—Å –ø–æ–ª—É—á–∏—Ç—Å—è –ø—Ä–æ–≤–µ—Å—Ç–∏ –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–π –æ—Ç–ø—É—Å–∫! üåÖüçπ'
                             f'', reply_markup=reply.main_kb)
    except Exception as e:
        await message.answer(f'–û—à–∏–±–∫–∞: {e}')

